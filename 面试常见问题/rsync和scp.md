# rsync和scp

rsync是一种常见的征粮备份工具，scp常被用做文件传输。

## rsync

可以进行软硬连接的拷贝。这个文件传输的方式是同步。

同步的过程中，如果从机的相关目录存在，那reync会惊醒数据比较，对数据不同的进行更新。

## scp

scp不支持连接的传输。传输方式是复制。

复制的过程中，如果从机存在相关的目录，会直接进行覆盖复制。

**从上边综合考虑，rsync更适合于文件同步，scp更适合于文件传输。**

# 大集群管理方案

1. 使用跳板机（这里可以使用jumpserver，开源），对集群进行统一管理
2. 使用自动化工具（ansible）
3. 运维安全：一般关闭selinux和firewalld，使用物理防火墙

# Toncat和Resin

Tomcat是很常用的一种java web服务器，用户多，适合于中小型企业。兼容性好，文献多。

Resin性能更好，常被大型企业采用。

# DNS解析过程

解析服从三个优先级：

1. 查看自身的hosts文件
2. 在本地设置的DNS服务器解析
3. 在跟服务器中解析（先查一级根服务器，再查二级根服务器）

# keepalived原理

再虚拟路由中，Master一直发送VRRP，BACKUP不会抢占VIP，当Master宕机时，BACKUP直接按照优先级抢占VIP。

# LVS原理

1. NAT模式
均衡器收到请求，将请求的目的IP转向RS。回传报文的适合，将RS的IP换成均衡器的IP。
优点：只需要均衡器有IP。
缺点：服务器过多时效率变低。

2. 路由模式（DR）
LVS做了调度器，请求发送到LVS上，LVS调度转发到RS上，RS直接返回数据，不经过LVS。
LVS的网卡和RS服务器的网卡需要再一个网段上。

3. 隧道模式（TUN）
多地多中心方案的调度器。此时的VIP，DIP和RIP都是公网IP。客户向VIP发送请求，调度器将请求转发给RS。
缺点：服务器局限部分linux系统

# MySQL复制延迟问题

1. 主从硬件差异
2. 主从线程不匹配
3. SQL赘余
4. 网络延迟
5. 主库压力大

# 栈和队列

栈： 先入后出，只可末尾单端操作。

队列： 先入先出，单端入，单端出。

# ping原理

用icmp协议探测远端请求是否可达。

# LNMP卡顿现象排查

1. 检查服务器的硬件负载（方案：查看MySQL负载，如果MySQL也能正常，那就可以考虑提升设备性能）
2. 检查服务器的网口负载（方案：使用CDN，加大宽带）
3. 检查Nginx连接、进程数量（方案：修改Nginx配置，适配于本设备硬件）
4. 查看php-fpm进程（方案：修改php.ini配置文件）
5. 查看MySQL负载，查日志（方案：拆日志，加redis等缓存技术）

# MySQL查询慢

1. 没有索引
2. I/O小
3. 内存不足
4. 网速较慢（也有外网连接的mysql）
5. 数据量过大
6. 死锁
7. 返回了不必要列
8. 没优化好

